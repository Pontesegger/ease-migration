<?xml version="1.0" encoding="UTF-8"?>
<?eclipse version="3.4"?>
<plugin>
   <extension
         point="org.eclipse.ui.newWizards">
      <wizard
            category="org.eclipse.ease.newWizard.category"
            class="org.eclipse.ease.modules.unittest.ui.wizards.TestSuiteWizard"
            icon="icons/eobj16/testsuite.png"
            id="org.eclipse.ease.unittest.wizard.newTestSuiteWizard"
            name="Script Testsuite">
      </wizard>
   </extension>
   <extension
         point="org.eclipse.ui.editors">
      <editor
            class="org.eclipse.ease.modules.unittest.ui.editor.TestSuiteEditor"
            default="true"
            icon="icons/eobj16/testsuite.png"
            id="org.eclipse.ease.editor.suiteEditor"
            name="Test Suite Editor">
         <contentTypeBinding
               contentTypeId="org.eclipse.ease.modules.unittest.ui.content.testsuite">
         </contentTypeBinding>
      </editor>
   </extension>
   <extension
         point="org.eclipse.core.contenttype.contentTypes">
      <content-type
            base-type="org.eclipse.core.runtime.xml"
            file-extensions="suite"
            id="org.eclipse.ease.modules.unittest.ui.content.testsuite"
            name="Test Suite Configuration"
            priority="normal">
      </content-type>
   </extension>
   <extension
         point="org.eclipse.ui.views">
      <view
            category="org.eclipse.ease.ui.views.category.scripting"
            class="org.eclipse.ease.modules.unittest.ui.views.UnitTestView"
            icon="icons/eview16/unit_test.png"
            id="org.eclipse.ease.views.unittest"
            name="Script Unit Test"
            restorable="true">
      </view>
   </extension>
   <extension
         point="org.eclipse.ui.decorators">
      <decorator
            class="org.eclipse.ease.modules.unittest.ui.decorators.TestDecorator"
            id="org.eclipse.ease.modules.unittest.decorator"
            label="Script Unit Test"
            lightweight="true"
            state="true">
         <enablement>
            <objectClass
                  name="org.eclipse.ease.modules.unittest.components.TestComposite">
            </objectClass></enablement>
      </decorator>
      <decorator
            class="org.eclipse.ease.modules.unittest.ui.decorators.MetadataDecorator"
            id="org.eclipse.ease.modules.unittest.metadata.decorator"
            label="Script Unit Test Metadata"
            lightweight="true"
            state="true">
         <enablement>
            <objectClass
                  name="org.eclipse.ease.modules.unittest.components.TestComposite">
            </objectClass>
         </enablement>
      </decorator>
   </extension>
   <extension
         point="org.eclipse.debug.core.launchConfigurationTypes">
      <launchConfigurationType
            delegate="org.eclipse.ease.modules.unittest.ui.launching.TestSuiteLaunchDelegate"
            id="org.eclipse.ease.unittest.launchConfigurationType"
            modes="run,debug"
            name="EASE UnitTest"
            sourceLocatorId="org.eclipse.ease.sourceLocator.generic">
      </launchConfigurationType>
   </extension>
   <extension
         point="org.eclipse.debug.ui.launchConfigurationTypeImages">
      <launchConfigurationTypeImage
            configTypeID="org.eclipse.ease.unittest.launchConfigurationType"
            icon="icons/eobj16/testsuite.png"
            id="org.eclipse.ease.unittest.launchConfigurationType.image">
      </launchConfigurationTypeImage>
   </extension>
   <extension
         point="org.eclipse.debug.ui.launchConfigurationTabGroups">
      <launchConfigurationTabGroup
            class="org.eclipse.ease.modules.unittest.ui.launching.TestSuiteTabGroup"
            id="org.eclipse.ease.unittest.launchConfigurationTabGroup"
            type="org.eclipse.ease.unittest.launchConfigurationType">
      </launchConfigurationTabGroup>
   </extension>
   <extension
         point="org.eclipse.debug.ui.launchShortcuts">
      <shortcut
            class="org.eclipse.ease.modules.unittest.ui.launching.TestSuiteLaunchDelegate"
            icon="icons/eobj16/testsuite.png"
            id="org.eclipse.ease.unittest.launchShortcut"
            label="EASE UnitTest"
            modes="run,debug">
         <contextualLaunch>
            <enablement>
               <iterate
                     ifEmpty="false"
                     operator="or">
                  <test
                        property="org.eclipse.debug.ui.matchesPattern"
                        value="suite">
                  </test>
               </iterate>
            </enablement>
         </contextualLaunch>
      </shortcut>
   </extension>
   <extension
         point="org.eclipse.ui.commands">
      <category
            id="org.eclipse.ease.commands.category.unittest"
            name="Unit Test">
      </category>
      <command
            categoryId="org.eclipse.ease.commands.category.unittest"
            defaultHandler="org.eclipse.ease.modules.unittest.ui.handler.ToggleTestFilter"
            description="Enable/disable filtering of valid tests"
            id="org.eclipse.ease.unittest.commands.filterTests"
            name="Toggle Valid Tests Filter">
         <state
               class="org.eclipse.jface.commands.ToggleState"
               id="STYLE">
         </state>
      </command>
      <command
            categoryId="org.eclipse.ease.commands.category.unittest"
            description="Create a test report"
            id="org.eclipse.ease.unittest.commands.createReport"
            name="Create Test Report">
      </command>
      <command
            categoryId="org.eclipse.ease.commands.category.unittest"
            description="Re-run all tests"
            id="org.eclipse.ease.unittest.commands.runAll"
            name="Run All Tests">
      </command>
      <command
            categoryId="org.eclipse.ease.commands.category.unittest"
            description="Re-run failed tests"
            id="org.eclipse.ease.unittest.commands.runFailed"
            name="Run Failed Tests">
      </command>
      <command
            categoryId="org.eclipse.ease.commands.category.unittest"
            description="Run selected tests"
            id="org.eclipse.ease.unittest.commands.runSelected"
            name="Run Selected Tests">
      </command>
      <command
            categoryId="org.eclipse.ease.commands.category.unittest"
            defaultHandler="org.eclipse.ease.modules.unittest.ui.handler.RunTestSuite"
            description="Run this Test Suite"
            id="org.eclipse.ease.unittest.commands.runTestSuite"
            name="Run Test Suite">
      </command>
      <command
            categoryId="org.eclipse.ease.commands.category.unittest"
            description="Stop this Test Suite"
            id="org.eclipse.ease.unittest.commands.stopTestSuite"
            name="Stop Test Suite">
      </command>
      <command
            categoryId="org.eclipse.ease.commands.category.unittest"
            defaultHandler="org.eclipse.ease.modules.unittest.ui.handler.LoadSuite"
            description="Load a TestSuite in the Unit View"
            id="org.eclipse.ease.unittest.commands.loadTestSuite"
            name="Load Test Suite">
         <commandParameter
               id="org.eclipse.ease.unittest.commands.loadTestSuite.suite"
               name="Suite file"
               optional="false">
         </commandParameter>
      </command>
      <command
            categoryId="org.eclipse.ease.commands.category.unittest"
            defaultHandler="org.eclipse.ease.modules.unittest.ui.handler.ExportErrorsAsSuite"
            description="Export failed tests as new test suite"
            id="org.eclipse.ease.unittest.commands.exportErrorsToSuite"
            name="Export errors to suite">
      </command>
      <command
            categoryId="org.eclipse.ease.commands.category.unittest"
            defaultHandler="org.eclipse.ease.modules.unittest.ui.handler.AddMetadataHandler"
            description="Add metadata to a test element"
            id="org.eclipse.ease.unittest.commands.addMetadata"
            name="Add Metadata">
      </command>
   </extension>
   <extension
         point="org.eclipse.ui.handlers">
      <handler
            class="org.eclipse.ease.modules.unittest.ui.handler.RunAllTests"
            commandId="org.eclipse.ease.unittest.commands.runAll">
         <enabledWhen>
            <not>
               <reference
                     definitionId="org.eclipse.ease.modules.unittest.ui.expression.isRunning">
               </reference>
            </not>
         </enabledWhen>
      </handler>
      <handler
            class="org.eclipse.ease.modules.unittest.ui.handler.RunFailedTests"
            commandId="org.eclipse.ease.unittest.commands.runFailed">
         <enabledWhen>
            <with
                  variable="org.eclipse.ease.modules.unittest.ui.testsuite">
               <or>
                  <test
                        forcePluginActivation="true"
                        property="org.eclipse.ease.modules.unittest.ui.status"
                        value="ERROR">
                  </test>
                  <test
                        forcePluginActivation="true"
                        property="org.eclipse.ease.modules.unittest.ui.status"
                        value="FAILURE">
                  </test>
               </or>
            </with>
         </enabledWhen>
      </handler>
      <handler
            class="org.eclipse.ease.modules.unittest.ui.handler.RunSelectedTests"
            commandId="org.eclipse.ease.unittest.commands.runSelected">
         <enabledWhen>
            <not>
               <reference
                     definitionId="org.eclipse.ease.modules.unittest.ui.expression.isRunning">
               </reference>
            </not>
         </enabledWhen>
      </handler>
      <handler
            class="org.eclipse.ease.modules.unittest.ui.handler.StopTestSuite"
            commandId="org.eclipse.ease.unittest.commands.stopTestSuite">
         <enabledWhen>
            <reference
                  definitionId="org.eclipse.ease.modules.unittest.ui.expression.isRunning">
            </reference>
         </enabledWhen>
      </handler>
      <handler
            class="org.eclipse.ease.modules.unittest.ui.handler.CreateReport"
            commandId="org.eclipse.ease.unittest.commands.createReport">
         <enabledWhen>
            <not>
               <reference
                     definitionId="org.eclipse.ease.modules.unittest.ui.expression.isRunning">
               </reference>
            </not>
         </enabledWhen>
      </handler>
   </extension>
   <extension
         point="org.eclipse.ui.menus">
      <menuContribution
            allPopups="false"
            locationURI="toolbar:org.eclipse.ease.editor.suiteEditor">
         <command
               commandId="org.eclipse.ease.unittest.commands.runTestSuite"
               icon="icons/elcl16/run_suite.png"
               style="push">
         </command>
      </menuContribution>
      <menuContribution
            allPopups="false"
            locationURI="toolbar:org.eclipse.ease.views.unittest">
         <command
               commandId="org.eclipse.ease.unittest.commands.loadTestSuite"
               icon="icons/eobj16/testsuite.png"
               id="org.eclipse.ease.unittest.commands.loadTestSuite.popup"
               style="pulldown">
         </command>
         <command
               commandId="org.eclipse.ui.navigate.collapseAll"
               style="push">
         </command>
         <command
               commandId="org.eclipse.ui.navigate.expandAll"
               style="push">
         </command>
         <command
               commandId="org.eclipse.ease.unittest.commands.filterTests"
               icon="icons/elcl16/pass_filter.png"
               style="toggle">
         </command>
         <separator
               name="separator1">
         </separator>
         <command
               commandId="org.eclipse.ease.unittest.commands.createReport"
               icon="icons/elcl16/create_report.png"
               style="push">
         </command>
         <command
               commandId="org.eclipse.ease.unittest.commands.exportErrorsToSuite"
               icon="icons/elcl16/export_error_suite.png"
               style="push">
         </command>
         <command
               commandId="org.eclipse.ease.unittest.commands.runAll"
               icon="icons/elcl16/run_all.png"
               style="push">
         </command>
         <command
               commandId="org.eclipse.ease.unittest.commands.runFailed"
               icon="icons/elcl16/run_fails.png"
               style="push">
         </command>
         <command
               commandId="org.eclipse.ease.unittest.commands.stopTestSuite"
               icon="platform:/plugin/org.eclipse.ui/icons/full/elcl16/stop.gif"
               style="push"
               tooltip="Stops the running testbench.">
         </command>
         <separator
               name="additions">
         </separator>
      </menuContribution>
      <menuContribution
            allPopups="false"
            locationURI="popup:org.eclipse.ease.views.unittest">
         <command
               commandId="org.eclipse.ease.unittest.commands.runSelected"
               icon="icons/elcl16/run_all.png"
               style="push">
            <visibleWhen
                  checkEnabled="false">
               <with
                     variable="selection">
                  <and>
                     <iterate>
                        <or>
                           <instanceof
                                 value="org.eclipse.ease.modules.unittest.components.TestSuite">
                           </instanceof>
                           <instanceof
                                 value="org.eclipse.ease.modules.unittest.components.TestFile">
                           </instanceof>
                           <instanceof
                                 value="org.eclipse.core.runtime.IPath">
                           </instanceof>
                        </or>
                     </iterate>
                  </and>
               </with>
            </visibleWhen>
         </command>
         <command
               commandId="org.eclipse.ease.unittest.commands.addMetadata"
               icon="icons/eobj16/metadata.png"
               style="push">
            <visibleWhen
                  checkEnabled="false">
               <with
                     variable="selection">
                  <and>
                     <count
                           value="1">
                     </count>
                     <iterate>
                        <instanceof
                              value="org.eclipse.ease.modules.unittest.components.TestComposite">
                        </instanceof>
                     </iterate>
                  </and>
               </with>
            </visibleWhen>
         </command>
      </menuContribution>
      <menuContribution
            allPopups="false"
            locationURI="menu:org.eclipse.ease.unittest.commands.loadTestSuite.popup">
         <dynamic
               class="org.eclipse.ease.modules.unittest.ui.handler.RecentSuiteFilesContributionFactory"
               id="org.eclipse.ease.modules.unittest.ui.testsuites">
         </dynamic>
      </menuContribution>
   </extension>
   <extension
         point="org.eclipse.core.expressions.definitions">
      <definition
            id="org.eclipse.ease.modules.unittest.ui.expression.isRunning">
         <with
               variable="org.eclipse.ease.modules.unittest.ui.testsuite">
            <test
                  forcePluginActivation="true"
                  property="org.eclipse.ease.modules.unittest.ui.status"
                  value="RUNNING">
            </test>
         </with>
      </definition>
   </extension>
   <extension
         point="org.eclipse.ui.perspectiveExtensions">
      <perspectiveExtension
            targetID="org.eclipse.ease.ui.perspectives.ScriptingPerspective">
         <view
               id="org.eclipse.ease.views.unittest"
               minimized="false"
               relationship="stack"
               relative="org.eclipse.ui.navigator.ProjectExplorer"
               visible="false">
         </view>
      </perspectiveExtension>
   </extension>
   <extension
         point="org.eclipse.core.expressions.propertyTesters">
      <propertyTester
            class="org.eclipse.ease.modules.unittest.ui.sourceprovider.TestSuiteTester"
            id="org.eclipse.ease.unittest.ui.propertyTester"
            namespace="org.eclipse.ease.modules.unittest.ui"
            properties="status"
            type="org.eclipse.ease.modules.unittest.components.TestSuite">
      </propertyTester>
   </extension>
   <extension
         point="org.eclipse.ui.services">
      <sourceProvider
            provider="org.eclipse.ease.modules.unittest.ui.sourceprovider.TestSuiteSource">
         <variable
               name="org.eclipse.ease.modules.unittest.ui.testsuite"
               priorityLevel="workbench">
         </variable>
      </sourceProvider>
   </extension>

</plugin>
